import calendar
import enum
from dataclasses import dataclass, field
from typing import Callable
from typing import Dict
from typing import List
from typing import Optional
from typing import Tuple

import numpy as np
import numpy.typing as npt
import matplotlib.pyplot as plt
from matplotlib.colors import LinearSegmentedColormap
from pydantic import BaseModel

from climatemaps.contour_config import ContourPlotConfig


class DataFormat(enum.Enum):
    GEOTIFF_WORLDCLIM_CMIP6 = "GEOTIFF_WORLDCLIM_CMIP6"
    GEOTIFF_WORLDCLIM_HISTORY = "GEOTIFF_WORLDCLIM_HISTORY"
    CRU_TS = "CRU_TS"  # Climatic Research Unit (CRU) Time-Series (TS)


class SpatialResolution(enum.Enum):
    MIN30 = "30m"
    MIN10 = "10m"
    MIN5 = "5m"
    MIN2_5 = "2.5m"


class ClimateVarKey(enum.Enum):
    PRECIPITATION = "PRECIPITATION"
    T_MAX = "T_MAX"
    T_MIN = "T_MIN"
    CLOUD_COVER = "CLOUD_COVER"
    WET_DAYS = "WET_DAYS"
    FROST_DAYS = "FROST_DAYS"
    WIND_SPEED = "WIND_SPEED"
    RADIATION = "RADIATION"
    DIURNAL_TEMP_RANGE = "DIURNAL_TEMP_RANGE"
    VAPOUR_PRESSURE = "VAPOUR_PRESSURE"


class ClimateScenario(enum.Enum):
    """
    Shared Socioeconomic Pathways (SSP) + expected level of radiative forcing in the year 2100
    """

    SSP126 = "SSP126"
    SSP245 = "SSP245"
    SSP370 = "SSP370"
    SSP585 = "SSP585"


class ClimateModel(enum.Enum):
    """
    Climate models used for future climate predictions
    """

    ENSEMBLE_MEAN = "ENSEMBLE_MEAN"
    ACCESS_CM2 = "ACCESS_CM2"
    BCC_CSM2_MR = "BCC_CSM2_MR"
    CMCC_ESM2 = "CMCC_ESM2"
    EC_EARTH3_VEG = "EC_Earth3_Veg"
    FIO_ESM_2_0 = "FIO_ESM_2_0"
    GFDL_ESM4 = "GFDL_ESM4"
    GISS_E2_1_G = "GISS_E2_1_G"
    HADGEM3_GC31_LL = "HadGEM3_GC31_LL"
    INM_CM5_0 = "INM_CM5_0"
    IPSL_CM6A_LR = "IPSL_CM6A_LR"
    MIROC6 = "MIROC6"
    MPI_ESM1_2_HR = "MPI_ESM1_2_HR"
    MRI_ESM2_0 = "MRI_ESM2_0"
    UKESM1_0_LL = "UKESM1_0_LL"

    @property
    def filename(self) -> str:
        return self.value.replace("_", "-")


class ClimateVariable(BaseModel):
    name: str
    display_name: str
    unit: str
    filename: str


CLIMATE_VARIABLES: Dict[ClimateVarKey, ClimateVariable] = {
    ClimateVarKey.PRECIPITATION: ClimateVariable(
        name="Precipitation", display_name="Precipitation", unit="mm/month", filename="prec"
    ),
    ClimateVarKey.T_MAX: ClimateVariable(
        name="Tmax", display_name="Temperature (Day)", unit="°C", filename="tmax"
    ),
    ClimateVarKey.T_MIN: ClimateVariable(
        name="Tmin", display_name="Temperature (Night)", unit="°C", filename="tmin"
    ),
    ClimateVarKey.CLOUD_COVER: ClimateVariable(
        name="CloudCover", display_name="Cloud Cover", unit="%", filename="cloud"
    ),
    ClimateVarKey.WET_DAYS: ClimateVariable(
        name="WetDays", display_name="Wet Days", unit="days", filename="wetdays"
    ),
    ClimateVarKey.FROST_DAYS: ClimateVariable(
        name="FrostDays", display_name="Frost Days", unit="days", filename="frostdays"
    ),
    ClimateVarKey.RADIATION: ClimateVariable(
        name="Radiation", display_name="Radiation", unit="W/m^2", filename="radiation"
    ),
    ClimateVarKey.DIURNAL_TEMP_RANGE: ClimateVariable(
        name="DiurnalTempRange",
        display_name="Diurnal Temperature Range",
        unit="°C",
        filename="diurnaltemprange",
    ),
    ClimateVarKey.VAPOUR_PRESSURE: ClimateVariable(
        name="VapourPressure", display_name="Vapour Pressure", unit="hPa", filename="vapourpressure"
    ),
}


def create_precipitation_colormap() -> LinearSegmentedColormap:
    """
    Create a custom precipitation colormap from the provided CSS gradient colors.
    The gradient goes from dark red through red, yellow, cyan, blue to white.
    """
    color_stops = [
        (0.0, (103, 0, 0)),
        (0.00245098, (107, 0, 0)),
        (0.00490196, (111, 0, 0)),
        (0.00735294, (114, 0, 0)),
        (0.00980392, (118, 0, 0)),
        (0.0122549, (122, 0, 0)),
        (0.0147059, (126, 0, 0)),
        (0.0171569, (130, 0, 0)),
        (0.0196078, (133, 0, 0)),
        (0.0220588, (137, 0, 0)),
        (0.0245098, (141, 0, 0)),
        (0.0269608, (145, 0, 0)),
        (0.0294118, (149, 0, 0)),
        (0.0318627, (152, 0, 0)),
        (0.0343137, (156, 0, 0)),
        (0.0367647, (160, 0, 0)),
        (0.0392157, (164, 0, 0)),
        (0.0416667, (168, 0, 0)),
        (0.0441176, (171, 0, 0)),
        (0.0465686, (175, 0, 0)),
        (0.0490196, (179, 0, 0)),
        (0.0514706, (183, 0, 0)),
        (0.0539216, (187, 0, 0)),
        (0.0563725, (190, 0, 0)),
        (0.0588235, (194, 0, 0)),
        (0.0612745, (198, 0, 0)),
        (0.0637255, (202, 0, 0)),
        (0.0661765, (206, 0, 0)),
        (0.0686275, (209, 0, 0)),
        (0.0710784, (213, 0, 0)),
        (0.0735294, (217, 0, 0)),
        (0.0759804, (221, 0, 0)),
        (0.0784314, (225, 0, 0)),
        (0.0808824, (228, 0, 0)),
        (0.0833333, (232, 0, 0)),
        (0.0857843, (236, 0, 0)),
        (0.0882353, (240, 0, 0)),
        (0.0906863, (244, 0, 0)),
        (0.0931373, (247, 0, 0)),
        (0.0955882, (251, 0, 0)),
        (0.0980392, (255, 0, 0)),
        (0.10049, (255, 6, 0)),
        (0.102941, (255, 11, 0)),
        (0.105392, (255, 17, 0)),
        (0.107843, (255, 23, 0)),
        (0.110294, (255, 28, 0)),
        (0.112745, (255, 34, 0)),
        (0.115196, (255, 40, 0)),
        (0.117647, (255, 45, 0)),
        (0.120098, (255, 51, 0)),
        (0.122549, (255, 57, 0)),
        (0.125, (255, 62, 0)),
        (0.127451, (255, 68, 0)),
        (0.129902, (255, 74, 0)),
        (0.132353, (255, 79, 0)),
        (0.134804, (255, 85, 0)),
        (0.137255, (255, 91, 0)),
        (0.139706, (255, 96, 0)),
        (0.142157, (255, 102, 0)),
        (0.144608, (255, 108, 0)),
        (0.147059, (255, 113, 0)),
        (0.14951, (255, 125, 0)),
        (0.151961, (255, 136, 0)),
        (0.154412, (255, 147, 0)),
        (0.156863, (255, 159, 0)),
        (0.159314, (255, 170, 0)),
        (0.161765, (255, 176, 0)),
        (0.164216, (255, 181, 0)),
        (0.166667, (255, 187, 0)),
        (0.169118, (255, 193, 0)),
        (0.171569, (255, 198, 0)),
        (0.17402, (255, 204, 0)),
        (0.176471, (255, 210, 0)),
        (0.178922, (255, 215, 0)),
        (0.181373, (255, 221, 0)),
        (0.183824, (255, 227, 0)),
        (0.186275, (255, 232, 0)),
        (0.188725, (255, 238, 0)),
        (0.191176, (255, 244, 0)),
        (0.193627, (255, 249, 0)),
        (0.196078, (255, 255, 0)),
        (0.198529, (246, 254, 0)),
        (0.20098, (237, 253, 0)),
        (0.203431, (228, 252, 0)),
        (0.205882, (219, 251, 0)),
        (0.208333, (210, 250, 0)),
        (0.210784, (201, 249, 0)),
        (0.213235, (192, 249, 0)),
        (0.215686, (183, 248, 0)),
        (0.218137, (174, 247, 0)),
        (0.220588, (165, 246, 0)),
        (0.223039, (156, 245, 0)),
        (0.22549, (147, 244, 0)),
        (0.227941, (139, 243, 0)),
        (0.230392, (130, 242, 0)),
        (0.232843, (121, 241, 0)),
        (0.235294, (112, 240, 0)),
        (0.237745, (103, 239, 0)),
        (0.240196, (94, 238, 0)),
        (0.242647, (85, 238, 0)),
        (0.245098, (76, 237, 0)),
        (0.247549, (67, 236, 0)),
        (0.25, (58, 235, 0)),
        (0.252451, (49, 234, 0)),
        (0.254902, (40, 233, 0)),
        (0.257353, (31, 232, 0)),
        (0.259804, (31, 228, 1)),
        (0.262255, (30, 224, 2)),
        (0.264706, (30, 220, 3)),
        (0.267157, (29, 217, 4)),
        (0.269608, (29, 213, 4)),
        (0.272059, (28, 209, 5)),
        (0.27451, (28, 205, 6)),
        (0.276961, (27, 201, 7)),
        (0.279412, (27, 197, 8)),
        (0.281863, (27, 194, 9)),
        (0.284314, (26, 190, 10)),
        (0.286765, (26, 186, 11)),
        (0.289216, (25, 182, 11)),
        (0.291667, (25, 178, 12)),
        (0.294118, (24, 174, 13)),
        (0.296569, (24, 171, 14)),
        (0.29902, (24, 167, 15)),
        (0.301471, (23, 163, 16)),
        (0.303922, (23, 159, 17)),
        (0.306373, (22, 155, 18)),
        (0.308824, (22, 151, 18)),
        (0.311275, (21, 148, 19)),
        (0.313725, (21, 144, 20)),
        (0.316176, (20, 140, 21)),
        (0.318627, (20, 136, 22)),
        (0.321078, (19, 141, 31)),
        (0.323529, (18, 146, 41)),
        (0.32598, (18, 150, 50)),
        (0.328431, (17, 155, 59)),
        (0.330882, (16, 160, 69)),
        (0.333333, (15, 165, 78)),
        (0.335784, (14, 169, 87)),
        (0.338235, (14, 174, 97)),
        (0.340686, (13, 179, 106)),
        (0.343137, (12, 184, 115)),
        (0.345588, (11, 188, 125)),
        (0.348039, (10, 193, 134)),
        (0.35049, (10, 198, 143)),
        (0.352941, (9, 203, 152)),
        (0.355392, (8, 207, 162)),
        (0.357843, (7, 212, 171)),
        (0.360294, (6, 217, 180)),
        (0.362745, (6, 222, 190)),
        (0.365196, (5, 226, 199)),
        (0.367647, (4, 231, 208)),
        (0.370098, (3, 236, 218)),
        (0.372549, (2, 241, 227)),
        (0.375, (2, 245, 236)),
        (0.377451, (1, 250, 246)),
        (0.379902, (0, 255, 255)),
        (0.382353, (0, 252, 255)),
        (0.384804, (0, 249, 255)),
        (0.387255, (0, 246, 255)),
        (0.389706, (0, 243, 255)),
        (0.392157, (0, 240, 255)),
        (0.394608, (0, 237, 255)),
        (0.397059, (0, 234, 255)),
        (0.39951, (0, 231, 255)),
        (0.401961, (0, 228, 255)),
        (0.404412, (0, 225, 255)),
        (0.406863, (0, 222, 255)),
        (0.409314, (0, 219, 255)),
        (0.411765, (0, 215, 255)),
        (0.414216, (0, 212, 255)),
        (0.416667, (0, 209, 255)),
        (0.419118, (0, 206, 255)),
        (0.421569, (0, 203, 255)),
        (0.42402, (0, 200, 255)),
        (0.426471, (0, 197, 255)),
        (0.428922, (0, 194, 255)),
        (0.431373, (0, 191, 255)),
        (0.433824, (0, 188, 255)),
        (0.436275, (0, 185, 255)),
        (0.438725, (0, 182, 255)),
        (0.441176, (0, 179, 255)),
        (0.443627, (0, 176, 255)),
        (0.446078, (0, 173, 255)),
        (0.448529, (0, 171, 255)),
        (0.45098, (0, 168, 255)),
        (0.453431, (0, 165, 255)),
        (0.455882, (0, 162, 255)),
        (0.458333, (0, 160, 255)),
        (0.460784, (0, 157, 255)),
        (0.463235, (0, 154, 255)),
        (0.465686, (0, 151, 255)),
        (0.468137, (0, 149, 255)),
        (0.470588, (0, 146, 255)),
        (0.473039, (0, 143, 255)),
        (0.47549, (0, 140, 255)),
        (0.477941, (0, 138, 255)),
        (0.480392, (0, 135, 255)),
        (0.482843, (0, 132, 255)),
        (0.485294, (0, 129, 255)),
        (0.487745, (0, 127, 255)),
        (0.490196, (0, 124, 255)),
        (0.492647, (0, 121, 255)),
        (0.495098, (0, 118, 255)),
        (0.497549, (0, 116, 255)),
        (0.5, (0, 113, 255)),
        (0.502451, (0, 110, 255)),
        (0.504902, (0, 106, 255)),
        (0.507353, (0, 101, 255)),
        (0.509804, (0, 97, 255)),
        (0.512255, (0, 92, 255)),
        (0.514706, (0, 88, 255)),
        (0.517157, (0, 84, 255)),
        (0.519608, (0, 79, 255)),
        (0.522059, (0, 75, 255)),
        (0.52451, (0, 70, 255)),
        (0.526961, (0, 66, 255)),
        (0.529412, (0, 62, 255)),
        (0.531863, (0, 57, 255)),
        (0.534314, (0, 53, 255)),
        (0.536765, (0, 48, 255)),
        (0.539216, (0, 44, 255)),
        (0.541667, (0, 40, 255)),
        (0.544118, (0, 35, 255)),
        (0.546569, (0, 31, 255)),
        (0.54902, (0, 26, 255)),
        (0.551471, (0, 22, 255)),
        (0.553922, (0, 18, 255)),
        (0.556373, (0, 13, 255)),
        (0.558824, (0, 9, 255)),
        (0.561275, (0, 4, 255)),
        (0.563725, (0, 0, 255)),
        (0.566176, (5, 0, 251)),
        (0.568627, (10, 1, 247)),
        (0.571078, (15, 1, 243)),
        (0.573529, (20, 2, 239)),
        (0.57598, (25, 2, 236)),
        (0.578431, (30, 3, 232)),
        (0.580882, (35, 3, 228)),
        (0.583333, (40, 4, 224)),
        (0.585784, (45, 4, 220)),
        (0.588235, (50, 5, 216)),
        (0.590686, (55, 5, 212)),
        (0.593137, (60, 6, 208)),
        (0.595588, (64, 6, 205)),
        (0.598039, (69, 7, 201)),
        (0.60049, (74, 7, 197)),
        (0.602941, (79, 8, 193)),
        (0.605392, (84, 8, 189)),
        (0.607843, (89, 9, 185)),
        (0.610294, (94, 9, 181)),
        (0.612745, (99, 10, 177)),
        (0.615196, (104, 10, 174)),
        (0.617647, (109, 11, 170)),
        (0.620098, (114, 11, 166)),
        (0.622549, (119, 12, 162)),
        (0.625, (124, 12, 158)),
        (0.627451, (127, 12, 160)),
        (0.629902, (129, 12, 162)),
        (0.632353, (132, 11, 164)),
        (0.634804, (134, 11, 166)),
        (0.637255, (137, 11, 168)),
        (0.639706, (140, 11, 170)),
        (0.642157, (142, 10, 172)),
        (0.644608, (145, 10, 174)),
        (0.647059, (148, 10, 175)),
        (0.64951, (150, 10, 177)),
        (0.651961, (153, 9, 179)),
        (0.654412, (155, 9, 181)),
        (0.656863, (158, 9, 183)),
        (0.659314, (161, 9, 185)),
        (0.661765, (163, 8, 187)),
        (0.664216, (166, 8, 189)),
        (0.666667, (169, 8, 191)),
        (0.669118, (171, 8, 193)),
        (0.671569, (174, 7, 195)),
        (0.67402, (176, 7, 197)),
        (0.676471, (179, 7, 199)),
        (0.678922, (182, 7, 201)),
        (0.681373, (184, 6, 203)),
        (0.683824, (187, 6, 205)),
        (0.686275, (190, 6, 206)),
        (0.688725, (196, 5, 211)),
        (0.691176, (203, 5, 216)),
        (0.693627, (209, 4, 221)),
        (0.696078, (216, 4, 226)),
        (0.698529, (222, 3, 231)),
        (0.70098, (229, 2, 236)),
        (0.703431, (235, 2, 240)),
        (0.705882, (242, 1, 245)),
        (0.708333, (248, 1, 250)),
        (0.710784, (255, 0, 255)),
        (0.713235, (255, 2, 255)),
        (0.715686, (255, 3, 255)),
        (0.718137, (255, 5, 255)),
        (0.720588, (255, 6, 255)),
        (0.723039, (255, 8, 255)),
        (0.72549, (255, 9, 255)),
        (0.727941, (255, 11, 255)),
        (0.730392, (255, 12, 255)),
        (0.732843, (255, 14, 255)),
        (0.735294, (255, 15, 255)),
        (0.737745, (255, 19, 254)),
        (0.740196, (255, 22, 254)),
        (0.742647, (255, 25, 254)),
        (0.745098, (255, 28, 254)),
        (0.747549, (255, 31, 254)),
        (0.75, (255, 34, 254)),
        (0.752451, (255, 37, 254)),
        (0.754902, (255, 40, 254)),
        (0.757353, (255, 43, 254)),
        (0.759804, (255, 46, 254)),
        (0.762255, (255, 49, 254)),
        (0.764706, (255, 53, 253)),
        (0.767157, (255, 56, 253)),
        (0.769608, (255, 59, 253)),
        (0.772059, (255, 62, 253)),
        (0.77451, (255, 65, 253)),
        (0.776961, (255, 68, 253)),
        (0.779412, (255, 71, 253)),
        (0.781863, (255, 74, 253)),
        (0.784314, (255, 77, 253)),
        (0.786765, (255, 80, 253)),
        (0.789216, (255, 83, 253)),
        (0.791667, (255, 87, 252)),
        (0.794118, (255, 90, 252)),
        (0.796569, (255, 93, 252)),
        (0.79902, (255, 96, 252)),
        (0.801471, (255, 99, 252)),
        (0.803922, (255, 102, 252)),
        (0.806373, (255, 105, 252)),
        (0.808824, (255, 108, 252)),
        (0.811275, (255, 111, 252)),
        (0.813725, (255, 114, 252)),
        (0.816176, (255, 117, 252)),
        (0.818627, (255, 121, 251)),
        (0.821078, (255, 124, 251)),
        (0.823529, (255, 127, 251)),
        (0.82598, (255, 130, 251)),
        (0.828431, (255, 133, 251)),
        (0.830882, (255, 136, 251)),
        (0.833333, (255, 139, 251)),
        (0.835784, (255, 142, 251)),
        (0.838235, (255, 145, 251)),
        (0.840686, (255, 148, 251)),
        (0.843137, (255, 151, 251)),
        (0.845588, (255, 155, 250)),
        (0.848039, (255, 158, 250)),
        (0.85049, (255, 161, 250)),
        (0.852941, (255, 164, 250)),
        (0.855392, (255, 167, 250)),
        (0.857843, (255, 170, 250)),
        (0.860294, (255, 171, 250)),
        (0.862745, (255, 172, 251)),
        (0.865196, (255, 172, 250)),
        (0.867647, (255, 173, 250)),
        (0.870098, (255, 174, 251)),
        (0.872549, (255, 174, 250)),
        (0.875, (255, 175, 250)),
        (0.877451, (255, 176, 251)),
        (0.879902, (255, 176, 250)),
        (0.882353, (255, 177, 250)),
        (0.884804, (255, 178, 250)),
        (0.887255, (255, 180, 251)),
        (0.889706, (255, 181, 251)),
        (0.892157, (255, 183, 251)),
        (0.894608, (255, 185, 251)),
        (0.897059, (255, 186, 251)),
        (0.89951, (255, 188, 251)),
        (0.901961, (255, 190, 251)),
        (0.904412, (255, 191, 251)),
        (0.906863, (255, 193, 251)),
        (0.909314, (255, 195, 251)),
        (0.911765, (255, 196, 252)),
        (0.914216, (255, 198, 252)),
        (0.916667, (255, 199, 252)),
        (0.919118, (255, 201, 252)),
        (0.921569, (255, 203, 252)),
        (0.92402, (255, 204, 252)),
        (0.926471, (255, 206, 252)),
        (0.928922, (255, 208, 252)),
        (0.931373, (255, 209, 252)),
        (0.933824, (255, 211, 252)),
        (0.936275, (255, 212, 252)),
        (0.938725, (255, 214, 253)),
        (0.941176, (255, 216, 253)),
        (0.943627, (255, 217, 253)),
        (0.946078, (255, 219, 253)),
        (0.948529, (255, 221, 253)),
        (0.95098, (255, 222, 253)),
        (0.953431, (255, 224, 253)),
        (0.955882, (255, 226, 253)),
        (0.958333, (255, 227, 253)),
        (0.960784, (255, 229, 253)),
        (0.963235, (255, 230, 254)),
        (0.965686, (255, 232, 254)),
        (0.968137, (255, 234, 254)),
        (0.970588, (255, 235, 254)),
        (0.973039, (255, 237, 254)),
        (0.97549, (255, 239, 254)),
        (0.977941, (255, 240, 254)),
        (0.980392, (255, 242, 254)),
        (0.982843, (255, 244, 254)),
        (0.985294, (255, 245, 254)),
        (0.987745, (255, 247, 255)),
        (0.990196, (255, 248, 255)),
        (0.992647, (255, 250, 255)),
        (0.995098, (255, 252, 255)),
        (0.997549, (255, 253, 255)),
        (1.0, (255, 255, 255)),
    ]

    colors = [(r / 255.0, g / 255.0, b / 255.0) for _, (r, g, b) in color_stops]
    positions = [pos for pos, _ in color_stops]

    cdict = {
        "red": [(pos, r, r) for pos, (r, g, b) in zip(positions, colors)],
        "green": [(pos, g, g) for pos, (r, g, b) in zip(positions, colors)],
        "blue": [(pos, b, b) for pos, (r, g, b) in zip(positions, colors)],
    }

    return LinearSegmentedColormap("precipitation_custom", cdict, N=256)


PRECIPITATION_COLORMAP = create_precipitation_colormap()


def create_temperature_colormap() -> LinearSegmentedColormap:
    """
    Create a custom temperature colormap from the provided CSS gradient colors.
    The gradient goes from light pink/magenta through purple, blue, cyan, green, yellow to red.
    """
    color_stops = [
        (0.0, (255, 240, 255)),
        (0.00121065, (255, 236, 255)),
        (0.00242131, (255, 232, 255)),
        (0.00363196, (255, 228, 255)),
        (0.00484262, (255, 223, 255)),
        (0.00605327, (255, 219, 255)),
        (0.00726392, (255, 215, 255)),
        (0.00847458, (255, 211, 255)),
        (0.00968523, (255, 207, 255)),
        (0.0108959, (255, 203, 255)),
        (0.0121065, (255, 199, 255)),
        (0.0133172, (255, 194, 255)),
        (0.0145278, (255, 190, 255)),
        (0.0157385, (255, 186, 255)),
        (0.0169492, (255, 182, 255)),
        (0.0181598, (255, 178, 255)),
        (0.0193705, (255, 174, 255)),
        (0.0205811, (255, 170, 255)),
        (0.0217918, (255, 166, 255)),
        (0.0230024, (255, 161, 255)),
        (0.0242131, (255, 157, 255)),
        (0.0254237, (255, 153, 255)),
        (0.0266344, (255, 149, 255)),
        (0.0278451, (255, 145, 255)),
        (0.0290557, (255, 141, 255)),
        (0.0302663, (255, 137, 255)),
        (0.031477, (255, 132, 255)),
        (0.0326877, (255, 128, 255)),
        (0.0338983, (255, 124, 255)),
        (0.035109, (255, 120, 255)),
        (0.0363196, (255, 116, 255)),
        (0.0375303, (255, 112, 255)),
        (0.0387409, (255, 108, 255)),
        (0.0399516, (255, 103, 255)),
        (0.0411622, (255, 99, 255)),
        (0.0423729, (255, 95, 255)),
        (0.0435835, (255, 91, 255)),
        (0.0447942, (255, 87, 255)),
        (0.0460048, (255, 83, 255)),
        (0.0472155, (255, 79, 255)),
        (0.0484262, (255, 74, 255)),
        (0.0496368, (255, 70, 255)),
        (0.0508475, (255, 66, 255)),
        (0.0520581, (255, 62, 255)),
        (0.0532688, (255, 58, 255)),
        (0.0544794, (255, 54, 255)),
        (0.0556901, (255, 50, 255)),
        (0.0569007, (255, 46, 255)),
        (0.0581114, (255, 41, 255)),
        (0.059322, (255, 37, 255)),
        (0.0605327, (255, 33, 255)),
        (0.0617433, (255, 29, 255)),
        (0.062954, (255, 25, 255)),
        (0.0641646, (255, 21, 255)),
        (0.0653753, (255, 17, 255)),
        (0.066586, (255, 12, 255)),
        (0.0677966, (255, 8, 255)),
        (0.0690073, (255, 4, 255)),
        (0.0702179, (255, 0, 255)),
        (0.0714286, (253, 0, 254)),
        (0.0726392, (251, 0, 252)),
        (0.0738499, (249, 0, 251)),
        (0.0750605, (247, 0, 249)),
        (0.0762712, (245, 0, 248)),
        (0.0774818, (243, 0, 247)),
        (0.0786925, (241, 0, 245)),
        (0.0799031, (239, 0, 244)),
        (0.0811138, (237, 0, 242)),
        (0.0823245, (235, 0, 241)),
        (0.0835351, (233, 0, 240)),
        (0.0847458, (231, 0, 238)),
        (0.0859564, (229, 0, 237)),
        (0.0871671, (227, 0, 235)),
        (0.0883777, (226, 0, 234)),
        (0.0895884, (224, 0, 233)),
        (0.090799, (222, 0, 231)),
        (0.0920097, (220, 0, 230)),
        (0.0932203, (218, 0, 228)),
        (0.094431, (216, 0, 227)),
        (0.0956416, (214, 0, 226)),
        (0.0968523, (212, 0, 224)),
        (0.098063, (210, 0, 223)),
        (0.0992736, (208, 0, 221)),
        (0.100484, (206, 0, 220)),
        (0.101695, (204, 0, 219)),
        (0.102906, (202, 0, 217)),
        (0.104116, (200, 0, 216)),
        (0.105327, (198, 0, 214)),
        (0.106538, (196, 0, 213)),
        (0.107748, (194, 0, 212)),
        (0.108959, (192, 0, 210)),
        (0.110169, (190, 0, 209)),
        (0.11138, (188, 0, 207)),
        (0.112591, (186, 0, 206)),
        (0.113801, (184, 0, 205)),
        (0.115012, (182, 0, 203)),
        (0.116223, (180, 0, 202)),
        (0.117433, (178, 0, 200)),
        (0.118644, (176, 0, 199)),
        (0.119855, (174, 0, 198)),
        (0.121065, (172, 0, 196)),
        (0.122276, (170, 0, 195)),
        (0.123487, (168, 0, 193)),
        (0.124697, (166, 0, 192)),
        (0.125908, (165, 0, 191)),
        (0.127119, (163, 0, 189)),
        (0.128329, (161, 0, 188)),
        (0.12954, (159, 0, 186)),
        (0.130751, (157, 0, 185)),
        (0.131961, (155, 0, 184)),
        (0.133172, (153, 0, 182)),
        (0.134383, (151, 0, 181)),
        (0.135593, (149, 0, 179)),
        (0.136804, (147, 0, 178)),
        (0.138015, (145, 0, 177)),
        (0.139225, (143, 0, 175)),
        (0.140436, (141, 0, 174)),
        (0.141647, (139, 0, 172)),
        (0.142857, (137, 0, 171)),
        (0.144068, (134, 0, 172)),
        (0.145278, (132, 0, 172)),
        (0.146489, (129, 0, 173)),
        (0.1477, (126, 0, 173)),
        (0.14891, (124, 0, 174)),
        (0.150121, (121, 0, 174)),
        (0.151332, (118, 0, 175)),
        (0.152542, (116, 0, 176)),
        (0.153753, (113, 0, 176)),
        (0.154964, (110, 0, 177)),
        (0.156174, (108, 0, 177)),
        (0.157385, (105, 0, 178)),
        (0.158596, (102, 0, 179)),
        (0.159806, (99, 0, 179)),
        (0.161017, (97, 0, 180)),
        (0.162228, (94, 0, 180)),
        (0.163438, (91, 0, 181)),
        (0.164649, (89, 0, 181)),
        (0.16586, (86, 0, 182)),
        (0.16707, (83, 0, 183)),
        (0.168281, (81, 0, 183)),
        (0.169492, (78, 0, 184)),
        (0.170702, (75, 0, 184)),
        (0.171913, (73, 0, 185)),
        (0.173123, (70, 0, 186)),
        (0.174334, (67, 0, 186)),
        (0.175545, (65, 0, 187)),
        (0.176755, (62, 0, 187)),
        (0.177966, (59, 0, 188)),
        (0.179177, (57, 0, 188)),
        (0.180387, (54, 0, 189)),
        (0.181598, (51, 0, 190)),
        (0.182809, (49, 0, 190)),
        (0.184019, (46, 0, 191)),
        (0.18523, (43, 0, 191)),
        (0.186441, (41, 0, 192)),
        (0.187651, (38, 0, 192)),
        (0.188862, (35, 0, 193)),
        (0.190073, (32, 0, 194)),
        (0.191283, (30, 0, 194)),
        (0.192494, (27, 0, 195)),
        (0.193705, (24, 0, 195)),
        (0.194915, (22, 0, 196)),
        (0.196126, (19, 0, 197)),
        (0.197337, (16, 0, 197)),
        (0.198547, (14, 0, 198)),
        (0.199758, (11, 0, 198)),
        (0.200969, (8, 0, 199)),
        (0.202179, (6, 0, 199)),
        (0.20339, (3, 0, 200)),
        (0.2046, (3, 0, 201)),
        (0.205811, (3, 0, 202)),
        (0.207022, (3, 0, 203)),
        (0.208232, (3, 0, 204)),
        (0.209443, (3, 0, 206)),
        (0.210654, (3, 0, 207)),
        (0.211864, (3, 0, 208)),
        (0.213075, (3, 0, 209)),
        (0.214286, (2, 0, 210)),
        (0.215496, (2, 0, 211)),
        (0.216707, (2, 0, 212)),
        (0.217918, (2, 0, 213)),
        (0.219128, (2, 0, 214)),
        (0.220339, (2, 0, 215)),
        (0.22155, (2, 0, 216)),
        (0.22276, (2, 0, 218)),
        (0.223971, (2, 0, 219)),
        (0.225182, (2, 0, 220)),
        (0.226392, (2, 0, 221)),
        (0.227603, (2, 0, 222)),
        (0.228814, (2, 0, 223)),
        (0.230024, (2, 0, 224)),
        (0.231235, (2, 0, 225)),
        (0.232446, (2, 0, 226)),
        (0.233656, (2, 0, 228)),
        (0.234867, (1, 0, 229)),
        (0.236078, (1, 0, 230)),
        (0.237288, (1, 0, 231)),
        (0.238499, (1, 0, 232)),
        (0.239709, (1, 0, 233)),
        (0.24092, (1, 0, 234)),
        (0.242131, (1, 0, 235)),
        (0.243341, (1, 0, 236)),
        (0.244552, (1, 0, 237)),
        (0.245763, (1, 0, 238)),
        (0.246973, (1, 0, 240)),
        (0.248184, (1, 0, 241)),
        (0.249395, (1, 0, 242)),
        (0.250605, (1, 0, 243)),
        (0.251816, (1, 0, 244)),
        (0.253027, (1, 0, 245)),
        (0.254237, (0, 0, 246)),
        (0.255448, (0, 0, 247)),
        (0.256659, (0, 0, 248)),
        (0.257869, (0, 0, 250)),
        (0.25908, (0, 0, 251)),
        (0.260291, (0, 0, 252)),
        (0.261501, (0, 0, 253)),
        (0.262712, (0, 0, 254)),
        (0.263923, (0, 0, 255)),
        (0.265133, (0, 2, 255)),
        (0.266344, (0, 3, 255)),
        (0.267554, (0, 5, 255)),
        (0.268765, (0, 7, 255)),
        (0.269976, (0, 8, 255)),
        (0.271186, (0, 10, 255)),
        (0.272397, (0, 12, 255)),
        (0.273608, (0, 14, 255)),
        (0.274818, (0, 15, 255)),
        (0.276029, (0, 17, 255)),
        (0.27724, (0, 19, 255)),
        (0.27845, (0, 20, 255)),
        (0.279661, (0, 22, 255)),
        (0.280872, (0, 24, 255)),
        (0.282082, (0, 26, 255)),
        (0.283293, (0, 27, 255)),
        (0.284504, (0, 29, 255)),
        (0.285714, (0, 31, 255)),
        (0.286925, (0, 32, 255)),
        (0.288136, (0, 34, 255)),
        (0.289346, (0, 36, 255)),
        (0.290557, (0, 37, 255)),
        (0.291768, (0, 39, 255)),
        (0.292978, (0, 41, 255)),
        (0.294189, (0, 42, 255)),
        (0.2954, (0, 44, 255)),
        (0.29661, (0, 46, 255)),
        (0.297821, (0, 48, 255)),
        (0.299031, (0, 49, 255)),
        (0.300242, (0, 51, 255)),
        (0.301453, (0, 53, 255)),
        (0.302663, (0, 54, 255)),
        (0.303874, (0, 56, 255)),
        (0.305085, (0, 58, 255)),
        (0.306295, (0, 60, 255)),
        (0.307506, (0, 61, 255)),
        (0.308717, (0, 63, 255)),
        (0.309927, (0, 65, 255)),
        (0.311138, (0, 66, 255)),
        (0.312349, (0, 68, 255)),
        (0.313559, (0, 70, 255)),
        (0.31477, (0, 71, 255)),
        (0.315981, (0, 73, 255)),
        (0.317191, (0, 75, 255)),
        (0.318402, (0, 76, 255)),
        (0.319613, (0, 78, 255)),
        (0.320823, (0, 80, 255)),
        (0.322034, (0, 82, 255)),
        (0.323245, (0, 83, 255)),
        (0.324455, (0, 85, 255)),
        (0.325666, (0, 87, 255)),
        (0.326877, (0, 88, 255)),
        (0.328087, (0, 90, 255)),
        (0.329298, (0, 92, 255)),
        (0.330508, (0, 94, 255)),
        (0.331719, (0, 95, 255)),
        (0.33293, (0, 97, 255)),
        (0.33414, (0, 99, 255)),
        (0.335351, (0, 100, 255)),
        (0.336562, (0, 102, 255)),
        (0.337772, (0, 104, 255)),
        (0.338983, (0, 105, 255)),
        (0.340194, (0, 107, 255)),
        (0.341404, (0, 109, 255)),
        (0.342615, (0, 110, 255)),
        (0.343826, (0, 112, 255)),
        (0.345036, (0, 114, 255)),
        (0.346247, (0, 116, 255)),
        (0.347458, (0, 117, 255)),
        (0.348668, (0, 119, 255)),
        (0.349879, (0, 121, 255)),
        (0.35109, (0, 122, 255)),
        (0.3523, (0, 124, 255)),
        (0.353511, (0, 126, 255)),
        (0.354722, (0, 128, 255)),
        (0.355932, (0, 129, 255)),
        (0.357143, (0, 131, 255)),
        (0.358354, (0, 133, 255)),
        (0.359564, (0, 134, 255)),
        (0.360775, (0, 136, 255)),
        (0.361986, (0, 138, 255)),
        (0.363196, (0, 139, 255)),
        (0.364407, (0, 141, 255)),
        (0.365617, (0, 143, 255)),
        (0.366828, (0, 144, 255)),
        (0.368039, (0, 146, 255)),
        (0.369249, (0, 148, 255)),
        (0.37046, (0, 150, 255)),
        (0.371671, (0, 151, 255)),
        (0.372881, (0, 153, 255)),
        (0.374092, (0, 155, 255)),
        (0.375303, (0, 156, 255)),
        (0.376513, (0, 158, 255)),
        (0.377724, (0, 160, 255)),
        (0.378935, (0, 162, 255)),
        (0.380145, (0, 163, 255)),
        (0.381356, (0, 165, 255)),
        (0.382567, (0, 167, 255)),
        (0.383777, (0, 168, 255)),
        (0.384988, (0, 170, 255)),
        (0.386199, (0, 172, 255)),
        (0.387409, (0, 173, 255)),
        (0.38862, (0, 175, 255)),
        (0.389831, (0, 177, 255)),
        (0.391041, (0, 178, 255)),
        (0.392252, (0, 180, 255)),
        (0.393462, (0, 182, 255)),
        (0.394673, (0, 184, 255)),
        (0.395884, (0, 185, 255)),
        (0.397094, (0, 187, 255)),
        (0.398305, (0, 189, 255)),
        (0.399516, (0, 190, 255)),
        (0.400726, (0, 192, 255)),
        (0.401937, (0, 194, 255)),
        (0.403148, (0, 196, 255)),
        (0.404358, (0, 197, 255)),
        (0.405569, (0, 199, 255)),
        (0.40678, (0, 201, 255)),
        (0.40799, (0, 202, 255)),
        (0.409201, (0, 204, 255)),
        (0.410412, (0, 206, 255)),
        (0.411622, (0, 207, 255)),
        (0.412833, (0, 209, 255)),
        (0.414044, (0, 211, 255)),
        (0.415254, (0, 212, 255)),
        (0.416465, (0, 214, 255)),
        (0.417676, (0, 216, 255)),
        (0.418886, (0, 218, 255)),
        (0.420097, (0, 219, 255)),
        (0.421308, (0, 221, 255)),
        (0.422518, (0, 223, 255)),
        (0.423729, (0, 224, 255)),
        (0.424939, (0, 226, 255)),
        (0.42615, (0, 228, 255)),
        (0.427361, (0, 230, 255)),
        (0.428571, (0, 231, 255)),
        (0.429782, (0, 233, 255)),
        (0.430993, (0, 235, 255)),
        (0.432203, (0, 236, 255)),
        (0.433414, (0, 238, 255)),
        (0.434625, (0, 240, 255)),
        (0.435835, (0, 241, 255)),
        (0.437046, (0, 243, 255)),
        (0.438257, (0, 245, 255)),
        (0.439467, (0, 246, 255)),
        (0.440678, (0, 248, 255)),
        (0.441889, (0, 250, 255)),
        (0.443099, (0, 252, 255)),
        (0.44431, (0, 253, 255)),
        (0.445521, (0, 255, 255)),
        (0.446731, (4, 254, 252)),
        (0.447942, (9, 252, 249)),
        (0.449153, (14, 251, 247)),
        (0.450363, (18, 249, 244)),
        (0.451574, (22, 248, 241)),
        (0.452785, (27, 246, 238)),
        (0.453995, (32, 245, 235)),
        (0.455206, (36, 243, 233)),
        (0.456416, (40, 242, 230)),
        (0.457627, (45, 240, 227)),
        (0.458838, (50, 239, 224)),
        (0.460048, (54, 237, 221)),
        (0.461259, (58, 236, 219)),
        (0.46247, (63, 234, 216)),
        (0.46368, (68, 233, 213)),
        (0.464891, (72, 232, 210)),
        (0.466102, (76, 230, 207)),
        (0.467312, (81, 229, 205)),
        (0.468523, (86, 227, 202)),
        (0.469734, (90, 226, 199)),
        (0.470944, (94, 224, 196)),
        (0.472155, (99, 223, 193)),
        (0.473366, (104, 221, 191)),
        (0.474576, (108, 220, 188)),
        (0.475787, (112, 218, 185)),
        (0.476998, (117, 217, 182)),
        (0.478208, (122, 215, 179)),
        (0.479419, (126, 214, 177)),
        (0.48063, (130, 212, 174)),
        (0.48184, (135, 211, 171)),
        (0.483051, (130, 208, 166)),
        (0.484263, (126, 204, 162)),
        (0.485473, (122, 201, 157)),
        (0.486684, (117, 198, 153)),
        (0.487895, (112, 194, 148)),
        (0.489105, (108, 191, 144)),
        (0.490316, (104, 187, 139)),
        (0.491527, (99, 184, 135)),
        (0.492737, (94, 181, 130)),
        (0.493948, (90, 177, 126)),
        (0.495159, (86, 174, 121)),
        (0.496369, (81, 171, 117)),
        (0.49758, (76, 167, 112)),
        (0.498791, (72, 164, 108)),
        (0.5, (68, 160, 103)),
        (0.501211, (63, 157, 98)),
        (0.502421, (58, 154, 94)),
        (0.503632, (54, 150, 89)),
        (0.504843, (50, 147, 85)),
        (0.506053, (45, 144, 80)),
        (0.507264, (40, 140, 76)),
        (0.508475, (36, 137, 71)),
        (0.509685, (32, 134, 67)),
        (0.510896, (27, 130, 62)),
        (0.512107, (22, 127, 58)),
        (0.513317, (18, 123, 53)),
        (0.514528, (14, 120, 49)),
        (0.515738, (9, 117, 44)),
        (0.516949, (4, 113, 40)),
        (0.51816, (0, 110, 35)),
        (0.51937, (0, 112, 34)),
        (0.520581, (0, 115, 34)),
        (0.521792, (0, 117, 33)),
        (0.523002, (0, 120, 33)),
        (0.524213, (0, 122, 32)),
        (0.525424, (0, 124, 32)),
        (0.526634, (0, 127, 31)),
        (0.527845, (0, 129, 30)),
        (0.529056, (0, 132, 30)),
        (0.530266, (0, 134, 29)),
        (0.531477, (0, 137, 29)),
        (0.532688, (0, 139, 28)),
        (0.533898, (0, 141, 27)),
        (0.535109, (0, 144, 27)),
        (0.53632, (0, 146, 26)),
        (0.53753, (0, 149, 26)),
        (0.538741, (0, 151, 25)),
        (0.539951, (0, 154, 24)),
        (0.541162, (0, 156, 24)),
        (0.542373, (0, 158, 23)),
        (0.543583, (0, 161, 23)),
        (0.544794, (0, 163, 22)),
        (0.546005, (0, 166, 22)),
        (0.547215, (0, 168, 21)),
        (0.548426, (0, 170, 20)),
        (0.549637, (0, 173, 20)),
        (0.550847, (0, 175, 19)),
        (0.552058, (0, 178, 19)),
        (0.553269, (0, 180, 18)),
        (0.554479, (0, 182, 18)),
        (0.55569, (0, 185, 17)),
        (0.556901, (0, 187, 16)),
        (0.558111, (0, 190, 16)),
        (0.559322, (0, 192, 15)),
        (0.560533, (0, 195, 15)),
        (0.561743, (0, 197, 14)),
        (0.562954, (0, 199, 13)),
        (0.564164, (0, 202, 13)),
        (0.565375, (0, 204, 12)),
        (0.566586, (0, 207, 12)),
        (0.567796, (0, 209, 11)),
        (0.569007, (0, 212, 10)),
        (0.570218, (0, 214, 10)),
        (0.571428, (0, 216, 9)),
        (0.572639, (0, 219, 9)),
        (0.57385, (0, 221, 8)),
        (0.57506, (0, 224, 8)),
        (0.576271, (0, 226, 7)),
        (0.577482, (0, 228, 6)),
        (0.578692, (0, 231, 6)),
        (0.579903, (0, 233, 5)),
        (0.581114, (0, 236, 5)),
        (0.582324, (0, 238, 4)),
        (0.583535, (0, 240, 3)),
        (0.584745, (0, 243, 3)),
        (0.585956, (0, 245, 2)),
        (0.587167, (0, 248, 2)),
        (0.588377, (0, 250, 1)),
        (0.589588, (0, 253, 1)),
        (0.590799, (0, 255, 0)),
        (0.592009, (8, 255, 0)),
        (0.59322, (17, 255, 0)),
        (0.594431, (26, 255, 0)),
        (0.595641, (34, 255, 0)),
        (0.596852, (42, 255, 0)),
        (0.598063, (51, 255, 0)),
        (0.599273, (60, 255, 0)),
        (0.600484, (68, 255, 0)),
        (0.601695, (76, 255, 0)),
        (0.602905, (85, 255, 0)),
        (0.604116, (94, 255, 0)),
        (0.605327, (102, 255, 0)),
        (0.606537, (110, 255, 0)),
        (0.607748, (119, 255, 0)),
        (0.608958, (128, 255, 0)),
        (0.610169, (136, 255, 0)),
        (0.61138, (144, 255, 0)),
        (0.61259, (153, 255, 0)),
        (0.613801, (162, 255, 0)),
        (0.615012, (170, 255, 0)),
        (0.616222, (178, 255, 0)),
        (0.617433, (187, 255, 0)),
        (0.618644, (196, 255, 0)),
        (0.619854, (204, 255, 0)),
        (0.621065, (212, 255, 0)),
        (0.622276, (221, 255, 0)),
        (0.623486, (230, 255, 0)),
        (0.624697, (238, 255, 0)),
        (0.625908, (246, 255, 0)),
        (0.627118, (255, 255, 0)),
        (0.628329, (255, 254, 0)),
        (0.62954, (255, 252, 0)),
        (0.63075, (255, 251, 0)),
        (0.631961, (255, 250, 0)),
        (0.633172, (255, 248, 0)),
        (0.634382, (255, 247, 0)),
        (0.635593, (255, 245, 0)),
        (0.636803, (255, 244, 0)),
        (0.638014, (255, 243, 0)),
        (0.639225, (255, 241, 0)),
        (0.640435, (255, 240, 0)),
        (0.641646, (255, 239, 0)),
        (0.642857, (255, 237, 0)),
        (0.644067, (255, 236, 0)),
        (0.645278, (255, 235, 0)),
        (0.646489, (255, 233, 0)),
        (0.647699, (255, 232, 0)),
        (0.64891, (255, 231, 0)),
        (0.650121, (255, 229, 0)),
        (0.651331, (255, 228, 0)),
        (0.652542, (255, 226, 0)),
        (0.653753, (255, 225, 0)),
        (0.654963, (255, 224, 0)),
        (0.656174, (255, 222, 0)),
        (0.657385, (255, 221, 0)),
        (0.658595, (255, 220, 0)),
        (0.659806, (255, 218, 0)),
        (0.661016, (255, 217, 0)),
        (0.662227, (255, 216, 0)),
        (0.663438, (255, 214, 0)),
        (0.664648, (255, 213, 0)),
        (0.665859, (255, 211, 0)),
        (0.66707, (255, 210, 0)),
        (0.66828, (255, 209, 0)),
        (0.669491, (255, 207, 0)),
        (0.670702, (255, 206, 0)),
        (0.671912, (255, 205, 0)),
        (0.673123, (255, 203, 0)),
        (0.674334, (255, 202, 0)),
        (0.675544, (255, 201, 0)),
        (0.676755, (255, 199, 0)),
        (0.677966, (255, 198, 0)),
        (0.679176, (255, 197, 0)),
        (0.680387, (255, 195, 0)),
        (0.681598, (255, 194, 0)),
        (0.682808, (255, 192, 0)),
        (0.684019, (255, 191, 0)),
        (0.68523, (255, 190, 0)),
        (0.68644, (255, 188, 0)),
        (0.687651, (255, 187, 0)),
        (0.688861, (255, 183, 0)),
        (0.690072, (255, 180, 0)),
        (0.691283, (255, 176, 0)),
        (0.692493, (255, 172, 0)),
        (0.693704, (255, 165, 0)),
        (0.694915, (255, 161, 0)),
        (0.696125, (255, 157, 0)),
        (0.697336, (255, 153, 0)),
        (0.698547, (255, 150, 0)),
        (0.699757, (255, 146, 0)),
        (0.700968, (255, 142, 0)),
        (0.702179, (255, 138, 0)),
        (0.703389, (255, 135, 0)),
        (0.7046, (255, 131, 0)),
        (0.705811, (255, 127, 0)),
        (0.707021, (255, 123, 0)),
        (0.708232, (255, 120, 0)),
        (0.709443, (255, 116, 0)),
        (0.710653, (255, 112, 0)),
        (0.711864, (255, 108, 0)),
        (0.713075, (255, 105, 0)),
        (0.714285, (255, 101, 0)),
        (0.715496, (255, 97, 0)),
        (0.716707, (255, 94, 0)),
        (0.717917, (255, 90, 0)),
        (0.719128, (255, 86, 0)),
        (0.720338, (255, 82, 0)),
        (0.721549, (255, 79, 0)),
        (0.72276, (255, 75, 0)),
        (0.72397, (255, 71, 0)),
        (0.725181, (255, 67, 0)),
        (0.726392, (255, 64, 0)),
        (0.727602, (255, 60, 0)),
        (0.728813, (255, 56, 0)),
        (0.730024, (255, 52, 0)),
        (0.731234, (255, 49, 0)),
        (0.732445, (255, 45, 0)),
        (0.733656, (255, 41, 0)),
        (0.734866, (255, 37, 0)),
        (0.736077, (255, 34, 0)),
        (0.737288, (255, 26, 0)),
        (0.738498, (255, 22, 0)),
        (0.739709, (255, 19, 0)),
        (0.74092, (255, 15, 0)),
        (0.74213, (255, 11, 0)),
        (0.743341, (255, 7, 0)),
        (0.744552, (255, 4, 0)),
        (0.745762, (255, 0, 0)),
        (0.746973, (253, 0, 0)),
        (0.748184, (251, 0, 0)),
        (0.749394, (249, 0, 0)),
        (0.750605, (247, 0, 0)),
        (0.751816, (246, 0, 0)),
        (0.753026, (244, 0, 0)),
        (0.754237, (242, 0, 0)),
        (0.755448, (240, 0, 0)),
        (0.756658, (238, 0, 0)),
        (0.757869, (236, 0, 0)),
        (0.759079, (234, 0, 0)),
        (0.76029, (232, 0, 0)),
        (0.761501, (230, 0, 0)),
        (0.762711, (229, 0, 0)),
        (0.763922, (227, 0, 0)),
        (0.765133, (225, 0, 0)),
        (0.766343, (223, 0, 0)),
        (0.767554, (221, 0, 0)),
        (0.768765, (219, 0, 0)),
        (0.769975, (217, 0, 0)),
        (0.771186, (215, 0, 0)),
        (0.772397, (214, 0, 0)),
        (0.773607, (212, 0, 0)),
        (0.774818, (210, 0, 0)),
        (0.776029, (208, 0, 0)),
        (0.777239, (206, 0, 0)),
        (0.77845, (204, 0, 0)),
        (0.779661, (202, 0, 0)),
        (0.780871, (200, 0, 0)),
        (0.782082, (198, 0, 0)),
        (0.783293, (197, 0, 0)),
        (0.784503, (195, 0, 0)),
        (0.785714, (193, 0, 0)),
        (0.786925, (191, 0, 0)),
        (0.788135, (189, 0, 0)),
        (0.789346, (187, 0, 0)),
        (0.790557, (185, 0, 0)),
        (0.791767, (183, 0, 0)),
        (0.792978, (181, 0, 0)),
        (0.794189, (180, 0, 0)),
        (0.795399, (178, 0, 0)),
        (0.79661, (176, 0, 0)),
        (0.797821, (174, 0, 0)),
        (0.799031, (172, 0, 0)),
        (0.800242, (170, 0, 0)),
        (0.801453, (168, 0, 0)),
        (0.802663, (166, 0, 0)),
        (0.803874, (164, 0, 0)),
        (0.805084, (163, 0, 0)),
        (0.806295, (161, 0, 0)),
        (0.807506, (159, 0, 0)),
        (0.808716, (157, 0, 0)),
        (0.809927, (155, 0, 0)),
        (0.811138, (153, 0, 0)),
        (0.812348, (151, 0, 0)),
        (0.813559, (149, 0, 0)),
        (0.81477, (148, 0, 0)),
        (0.81598, (146, 0, 0)),
        (0.817191, (144, 0, 0)),
        (0.818402, (142, 0, 0)),
        (0.819612, (140, 0, 0)),
        (0.820823, (138, 0, 0)),
        (0.822034, (136, 0, 0)),
        (0.823244, (134, 0, 0)),
        (0.824455, (132, 0, 0)),
        (0.825666, (131, 0, 0)),
        (0.826876, (129, 0, 0)),
        (0.828087, (127, 0, 0)),
        (0.829298, (125, 0, 0)),
        (0.830508, (123, 0, 0)),
        (0.831719, (126, 4, 4)),
        (0.83293, (129, 9, 9)),
        (0.83414, (133, 14, 14)),
        (0.835351, (136, 18, 18)),
        (0.836562, (139, 22, 22)),
        (0.837772, (142, 27, 27)),
        (0.838983, (145, 32, 32)),
        (0.840194, (148, 36, 36)),
        (0.841404, (152, 40, 40)),
        (0.842615, (155, 45, 45)),
        (0.843826, (158, 50, 50)),
        (0.845036, (161, 54, 54)),
        (0.846247, (164, 58, 58)),
        (0.847458, (167, 63, 63)),
        (0.848668, (171, 68, 68)),
        (0.849879, (174, 72, 72)),
        (0.85109, (177, 76, 76)),
        (0.8523, (180, 81, 81)),
        (0.853511, (183, 86, 86)),
        (0.854722, (186, 90, 90)),
        (0.855932, (190, 94, 94)),
        (0.857143, (193, 99, 99)),
        (0.858354, (196, 104, 104)),
        (0.859564, (199, 108, 108)),
        (0.860775, (202, 112, 112)),
        (0.861986, (206, 117, 117)),
        (0.863196, (209, 122, 122)),
        (0.864407, (212, 126, 126)),
        (0.865617, (215, 130, 130)),
        (0.866828, (218, 135, 135)),
        (0.868039, (221, 140, 140)),
        (0.869249, (225, 144, 144)),
        (0.87046, (228, 148, 148)),
        (0.871671, (231, 153, 153)),
        (0.872881, (234, 158, 158)),
        (0.874092, (237, 162, 162)),
        (0.875303, (240, 166, 166)),
        (0.876513, (244, 171, 171)),
        (0.877724, (247, 176, 176)),
        (0.878935, (250, 180, 180)),
        (0.880145, (250, 182, 182)),
        (0.881356, (250, 183, 183)),
        (0.882567, (250, 184, 184)),
        (0.883777, (250, 186, 186)),
        (0.884988, (251, 188, 188)),
        (0.886199, (251, 189, 189)),
        (0.887409, (251, 190, 190)),
        (0.88862, (251, 192, 192)),
        (0.889831, (251, 194, 194)),
        (0.891041, (251, 195, 195)),
        (0.892252, (251, 196, 196)),
        (0.893462, (252, 198, 198)),
        (0.894673, (252, 200, 200)),
        (0.895884, (252, 201, 201)),
        (0.897094, (252, 202, 202)),
        (0.898305, (252, 204, 204)),
        (0.899516, (252, 206, 206)),
        (0.900726, (252, 207, 207)),
        (0.901937, (252, 208, 208)),
        (0.903148, (252, 210, 210)),
        (0.904358, (253, 212, 212)),
        (0.905569, (253, 213, 213)),
        (0.90678, (253, 214, 214)),
        (0.90799, (253, 216, 216)),
        (0.909201, (253, 218, 218)),
        (0.910412, (253, 219, 219)),
        (0.911622, (253, 220, 220)),
        (0.912833, (254, 222, 222)),
        (0.914044, (254, 224, 224)),
        (0.915254, (254, 225, 225)),
        (0.916465, (254, 226, 226)),
        (0.917676, (254, 228, 228)),
        (0.918886, (254, 230, 230)),
        (0.920097, (254, 231, 231)),
        (0.921308, (254, 232, 232)),
        (0.922518, (254, 234, 234)),
        (0.923729, (255, 236, 236)),
        (0.924939, (255, 237, 237)),
        (0.92615, (255, 238, 238)),
        (0.927361, (255, 240, 240)),
        (0.928571, (252, 238, 238)),
        (0.929782, (250, 235, 235)),
        (0.930993, (247, 233, 233)),
        (0.932203, (244, 230, 230)),
        (0.933414, (242, 228, 228)),
        (0.934625, (239, 226, 226)),
        (0.935835, (236, 223, 223)),
        (0.937046, (234, 221, 221)),
        (0.938257, (231, 218, 218)),
        (0.939467, (228, 216, 216)),
        (0.940678, (226, 213, 213)),
        (0.941889, (223, 211, 211)),
        (0.943099, (220, 209, 209)),
        (0.94431, (218, 206, 206)),
        (0.945521, (215, 204, 204)),
        (0.946731, (212, 201, 201)),
        (0.947942, (210, 199, 199)),
        (0.949153, (207, 197, 197)),
        (0.950363, (204, 194, 194)),
        (0.951574, (202, 192, 192)),
        (0.952785, (199, 189, 189)),
        (0.953995, (196, 187, 187)),
        (0.955206, (194, 184, 184)),
        (0.956416, (191, 182, 182)),
        (0.957627, (188, 180, 180)),
        (0.958838, (186, 177, 177)),
        (0.960048, (183, 175, 175)),
        (0.961259, (180, 172, 172)),
        (0.96247, (178, 170, 170)),
        (0.96368, (175, 168, 168)),
        (0.964891, (172, 165, 165)),
        (0.966102, (169, 163, 163)),
        (0.967312, (167, 160, 160)),
        (0.968523, (164, 158, 158)),
        (0.969734, (161, 156, 156)),
        (0.970944, (159, 153, 153)),
        (0.972155, (156, 151, 151)),
        (0.973366, (153, 148, 148)),
        (0.974576, (151, 146, 146)),
        (0.975787, (148, 143, 143)),
        (0.976998, (145, 141, 141)),
        (0.978208, (143, 139, 139)),
        (0.979419, (140, 136, 136)),
        (0.98063, (137, 134, 134)),
        (0.98184, (135, 131, 131)),
        (0.983051, (132, 129, 129)),
        (0.984262, (129, 127, 127)),
        (0.985472, (127, 124, 124)),
        (0.986683, (124, 122, 122)),
        (0.987894, (121, 119, 119)),
        (0.989104, (119, 117, 117)),
        (0.990315, (116, 114, 114)),
        (0.991526, (113, 112, 112)),
        (0.992736, (111, 110, 110)),
        (0.993947, (108, 107, 107)),
        (0.995158, (105, 105, 105)),
        (0.996368, (103, 102, 102)),
        (0.997579, (100, 100, 100)),
        (1.0, (100, 100, 100)),
    ]

    colors = [(r / 255.0, g / 255.0, b / 255.0) for _, (r, g, b) in color_stops]
    positions = [pos for pos, _ in color_stops]

    cdict = {
        "red": [(pos, r, r) for pos, (r, g, b) in zip(positions, colors)],
        "green": [(pos, g, g) for pos, (r, g, b) in zip(positions, colors)],
        "blue": [(pos, b, b) for pos, (r, g, b) in zip(positions, colors)],
    }

    return LinearSegmentedColormap("temperature_custom", cdict, N=256)


TEMPERATURE_COLORMAP = create_temperature_colormap()


CLIMATE_CONTOUR_CONFIGS: Dict[ClimateVarKey, ContourPlotConfig] = {
    ClimateVarKey.PRECIPITATION: ContourPlotConfig(
        level_lower=5,
        level_upper=400,
        colormap=PRECIPITATION_COLORMAP,
        title="Precipitation",
        unit="mm/month",
        log_scale=True,
    ),
    ClimateVarKey.T_MAX: ContourPlotConfig(
        level_lower=-20,
        level_upper=45,
        colormap=TEMPERATURE_COLORMAP,
        title="Temperature (Day)",
        unit="C",
    ),
    ClimateVarKey.T_MIN: ContourPlotConfig(
        level_lower=-30,
        level_upper=28,
        colormap=TEMPERATURE_COLORMAP,
        title="Temperature (Night)",
        unit="C",
    ),
    ClimateVarKey.CLOUD_COVER: ContourPlotConfig(
        level_lower=0, level_upper=100, colormap=plt.cm.RdYlBu, title="Cloud coverage", unit="%"
    ),
    ClimateVarKey.WET_DAYS: ContourPlotConfig(
        level_lower=0, level_upper=30, colormap=plt.cm.RdYlBu, title="Wet days", unit="days"
    ),
    ClimateVarKey.FROST_DAYS: ContourPlotConfig(
        level_lower=0, level_upper=30, colormap=plt.cm.RdYlBu, title="Frost days", unit="days"
    ),
    ClimateVarKey.RADIATION: ContourPlotConfig(
        level_lower=0, level_upper=300, colormap=plt.cm.RdYlBu_r, title="Radiation", unit="W/m^2"
    ),
    ClimateVarKey.DIURNAL_TEMP_RANGE: ContourPlotConfig(
        level_lower=5,
        level_upper=20,
        colormap=plt.cm.jet,
        title="Diurnal temperature range",
        unit="C",
    ),
    ClimateVarKey.VAPOUR_PRESSURE: ContourPlotConfig(
        level_lower=1, level_upper=34, colormap=plt.cm.jet, title="Vapour pressure", unit="hPa"
    ),
}

# Contour configurations for difference maps (future - historical)
# Only includes variables that have both historical and future data available
CLIMATE_DIFFERENCE_CONTOUR_CONFIGS: Dict[ClimateVarKey, ContourPlotConfig] = {
    ClimateVarKey.PRECIPITATION: ContourPlotConfig(
        level_lower=-35,
        level_upper=35,
        colormap=plt.cm.RdBu,
        title="Precipitation Change",
        unit="mm/month",
    ),
    ClimateVarKey.T_MAX: ContourPlotConfig(
        level_lower=-6,
        level_upper=6,
        colormap=plt.cm.RdYlBu_r,
        title="Temperature (Day) Change",
        unit="°C",
    ),
    ClimateVarKey.T_MIN: ContourPlotConfig(
        level_lower=-5,
        level_upper=5,
        colormap=plt.cm.RdYlBu_r,
        title="Temperature (Night) Change",
        unit="°C",
    ),
}


def convert_per_month_to_per_day(
    v: npt.NDArray[np.floating], month: int
) -> npt.NDArray[np.floating]:
    days_in_month = calendar.monthrange(2025, month)[1]
    return v / days_in_month


@dataclass
class ClimateDataConfig:
    variable_type: ClimateVarKey
    filepath: str
    format: DataFormat
    resolution: SpatialResolution
    year_range: Tuple[int, int]
    conversion_function: Callable[[npt.NDArray[np.floating], int], npt.NDArray[np.floating]] = None
    conversion_factor: float = 1
    source: Optional[str] = None

    @property
    def variable(self) -> ClimateVariable:
        return CLIMATE_VARIABLES[self.variable_type]

    @property
    def data_type_slug(self) -> str:
        return f"{self.variable.name}_{self.year_range[0]}_{self.year_range[1]}_{self.resolution.value}".lower().replace(
            ".", "_"
        )

    @property
    def contour_config(self) -> ContourPlotConfig:
        return CLIMATE_CONTOUR_CONFIGS[self.variable_type]


@dataclass
class FutureClimateDataConfig(ClimateDataConfig):
    climate_scenario: ClimateScenario = field(default=None)
    climate_model: ClimateModel = field(default=None)

    @property
    def data_type_slug(self) -> str:
        base_slug = super().data_type_slug
        return f"{base_slug}_{self.climate_scenario.name}_{self.climate_model.name}".lower()


@dataclass
class ClimateDifferenceDataConfig(ClimateDataConfig):
    """
    Configuration for climate difference maps (future - historical)
    """

    historical_config: ClimateDataConfig = field(default=None)
    future_config: FutureClimateDataConfig = field(default=None)

    @property
    def data_type_slug(self) -> str:
        if self.future_config and self.historical_config:
            return f"difference_{self.variable.name}_{self.historical_config.year_range[0]}_{self.historical_config.year_range[1]}_to_{self.future_config.year_range[0]}_{self.future_config.year_range[1]}_{self.resolution.value}_{self.future_config.climate_scenario.name}_{self.future_config.climate_model.name}".lower().replace(
                ".", "_"
            )
        return super().data_type_slug

    @property
    def contour_config(self) -> ContourPlotConfig:
        return CLIMATE_DIFFERENCE_CONTOUR_CONFIGS[self.variable_type]


@dataclass
class ClimateDataConfigGroup:
    variable_types: List[ClimateVarKey]
    format: DataFormat
    resolutions: List[SpatialResolution]
    year_ranges: List[Tuple[int, int]]
    conversion_function: Callable[[npt.NDArray[np.floating], int], npt.NDArray[np.floating]] = None
    conversion_factor: float = 1
    source: Optional[str] = None
    configs: List[ClimateDataConfig] = ()
    filepath_template: Optional[str] = None

    def __post_init__(self):
        for cfg in self.configs:
            cfg.group = self

    def create_configs(self) -> List[ClimateDataConfig]:
        configs: List[ClimateDataConfig] = []
        for variable_type in self.variable_types:
            for year_range in self.year_ranges:
                for resolution in self.resolutions:
                    variable = CLIMATE_VARIABLES[variable_type]
                    config = ClimateDataConfig(
                        variable_type=variable_type,
                        format=self.format,
                        resolution=resolution,
                        year_range=year_range,
                        filepath=self.filepath_template.format(
                            resolution=resolution.value,
                            year_range=year_range,
                            variable_name=variable.filename.lower(),
                        ),
                        conversion_function=self.conversion_function,
                        conversion_factor=self.conversion_factor,
                    )
                    configs.append(config)
        return configs


@dataclass
class FutureClimateDataConfigGroup(ClimateDataConfigGroup):
    climate_scenarios: List[ClimateScenario] = field(default_factory=list)
    climate_models: List[ClimateModel] = field(default_factory=list)
    configs: List[FutureClimateDataConfig] = field(default_factory=list)

    def create_configs(self) -> List[FutureClimateDataConfig]:
        configs: List[FutureClimateDataConfig] = []
        for variable_type in self.variable_types:
            for year_range in self.year_ranges:
                for resolution in self.resolutions:
                    for climate_scenario in self.climate_scenarios:
                        for climate_model in self.climate_models:
                            config = FutureClimateDataConfig(
                                variable_type=variable_type,
                                format=self.format,
                                resolution=resolution,
                                year_range=year_range,
                                climate_scenario=climate_scenario,
                                climate_model=climate_model,
                                filepath=self.filepath_template.format(
                                    resolution=resolution.value,
                                    year_range=year_range,
                                    variable_name=CLIMATE_VARIABLES[variable_type].filename.lower(),
                                    climate_scenario=climate_scenario.name.lower(),
                                    climate_model=climate_model.filename,
                                ),
                                conversion_function=self.conversion_function,
                                conversion_factor=self.conversion_factor,
                                source=self.source,
                            )
                            configs.append(config)
        return configs


CRU_TS_FILE_ABBREVIATIONS: Dict[ClimateVarKey, str] = {
    ClimateVarKey.CLOUD_COVER: "cld",
    ClimateVarKey.DIURNAL_TEMP_RANGE: "dtr",
    ClimateVarKey.WET_DAYS: "wet",
    ClimateVarKey.FROST_DAYS: "frs",
    ClimateVarKey.VAPOUR_PRESSURE: "vap",
    ClimateVarKey.T_MAX: "tmx",
    ClimateVarKey.T_MIN: "tmn",
    ClimateVarKey.PRECIPITATION: "pre",
}


@dataclass
class CRUTSClimateDataConfigGroup(ClimateDataConfigGroup):
    def create_configs(self) -> List[ClimateDataConfig]:
        configs: List[ClimateDataConfig] = []
        for variable_type in self.variable_types:
            for year_range in self.year_ranges:
                for resolution in self.resolutions:
                    abbr = CRU_TS_FILE_ABBREVIATIONS[variable_type]
                    config = ClimateDataConfig(
                        variable_type=variable_type,
                        format=self.format,
                        resolution=resolution,
                        year_range=year_range,
                        filepath=f"data/raw/cruts/cru_{abbr}_clim_{year_range[0]}-{year_range[1]}",
                        conversion_function=self.conversion_function,
                        conversion_factor=self.conversion_factor,
                        source=self.source,
                    )
                    configs.append(config)
        return configs


HISTORIC_DATA_GROUPS: List[ClimateDataConfigGroup] = [
    ClimateDataConfigGroup(
        variable_types=[ClimateVarKey.T_MAX, ClimateVarKey.T_MIN, ClimateVarKey.PRECIPITATION],
        format=DataFormat.GEOTIFF_WORLDCLIM_HISTORY,
        source="https://www.worldclim.org/data/worldclim21.html",
        resolutions=[SpatialResolution.MIN10, SpatialResolution.MIN5],
        year_ranges=[(1970, 2000)],
        filepath_template="data/raw/worldclim/history/wc2.1_{resolution}_{variable_name}",
    ),
    CRUTSClimateDataConfigGroup(
        variable_types=[
            ClimateVarKey.WET_DAYS,
            ClimateVarKey.FROST_DAYS,
        ],
        format=DataFormat.CRU_TS,
        source="https://ipcc-browser.ipcc-data.org/browser/dataset/653/0",
        resolutions=[SpatialResolution.MIN30],
        year_ranges=[(1961, 1990)],
        conversion_factor=0.124,
    ),
    CRUTSClimateDataConfigGroup(
        variable_types=[
            ClimateVarKey.DIURNAL_TEMP_RANGE,
        ],
        format=DataFormat.CRU_TS,
        source="https://ipcc-browser.ipcc-data.org/browser/dataset/653/0",
        resolutions=[SpatialResolution.MIN30],
        year_ranges=[(1961, 1990)],
        conversion_factor=0.16,
    ),
    CRUTSClimateDataConfigGroup(
        variable_types=[
            ClimateVarKey.VAPOUR_PRESSURE,
        ],
        format=DataFormat.CRU_TS,
        source="https://ipcc-browser.ipcc-data.org/browser/dataset/653/0",
        resolutions=[SpatialResolution.MIN30],
        year_ranges=[(1961, 1990)],
        conversion_factor=0.2,
    ),
    CRUTSClimateDataConfigGroup(
        variable_types=[ClimateVarKey.CLOUD_COVER],
        format=DataFormat.CRU_TS,
        source="https://ipcc-browser.ipcc-data.org/browser/dataset/653/0",
        resolutions=[SpatialResolution.MIN30],
        year_ranges=[(1961, 1990)],
        conversion_factor=0.4,  # https://www.ipcc-data.org/obs/info/cru10/cru_cld_clim_1901-1910.html
    ),
]


FUTURE_FILE_TEMPLATE = "data/raw/worldclim/future/wc2.1_{resolution}_{variable_name}_{climate_model}_{climate_scenario}_{year_range[0]}-{year_range[1]}.tif"
FUTURE_DATE_RANGES = [(2021, 2040), (2041, 2060), (2061, 2080), (2081, 2100)]

FUTURE_DATA_GROUPS: List[FutureClimateDataConfigGroup] = [
    FutureClimateDataConfigGroup(
        variable_types=[ClimateVarKey.T_MIN, ClimateVarKey.T_MAX, ClimateVarKey.PRECIPITATION],
        format=DataFormat.GEOTIFF_WORLDCLIM_CMIP6,
        source="https://www.worldclim.org/data/cmip6/cmip6climate.html",
        resolutions=[SpatialResolution.MIN10, SpatialResolution.MIN5],
        year_ranges=FUTURE_DATE_RANGES,
        climate_scenarios=[
            ClimateScenario.SSP126,
            ClimateScenario.SSP245,
            ClimateScenario.SSP370,
            ClimateScenario.SSP585,
        ],
        climate_models=[
            ClimateModel.ENSEMBLE_MEAN,
        ],
        filepath_template=FUTURE_FILE_TEMPLATE,
    ),
    FutureClimateDataConfigGroup(
        variable_types=[ClimateVarKey.T_MIN, ClimateVarKey.T_MAX, ClimateVarKey.PRECIPITATION],
        format=DataFormat.GEOTIFF_WORLDCLIM_CMIP6,
        source="https://www.worldclim.org/data/cmip6/cmip6climate.html",
        resolutions=[SpatialResolution.MIN10],
        year_ranges=FUTURE_DATE_RANGES,
        climate_scenarios=[
            ClimateScenario.SSP126,
            ClimateScenario.SSP245,
            ClimateScenario.SSP370,
            ClimateScenario.SSP585,
        ],
        climate_models=[
            ClimateModel.EC_EARTH3_VEG,
            ClimateModel.ACCESS_CM2,
            ClimateModel.MPI_ESM1_2_HR,
        ],
        filepath_template=FUTURE_FILE_TEMPLATE,
    ),
    FutureClimateDataConfigGroup(
        variable_types=[ClimateVarKey.T_MIN, ClimateVarKey.T_MAX, ClimateVarKey.PRECIPITATION],
        format=DataFormat.GEOTIFF_WORLDCLIM_CMIP6,
        source="https://www.worldclim.org/data/cmip6/cmip6climate.html",
        resolutions=[SpatialResolution.MIN10],
        year_ranges=FUTURE_DATE_RANGES,
        climate_scenarios=[
            ClimateScenario.SSP126,
            ClimateScenario.SSP370,
        ],
        climate_models=[
            ClimateModel.GFDL_ESM4,
        ],
        filepath_template=FUTURE_FILE_TEMPLATE,
    ),
]

HISTORIC_DATA_SETS: List[ClimateDataConfig] = [
    cfg for data_group in HISTORIC_DATA_GROUPS for cfg in data_group.create_configs()
]

FUTURE_DATA_SETS: List[FutureClimateDataConfig] = [
    cfg for data_group in FUTURE_DATA_GROUPS for cfg in data_group.create_configs()
]


def create_difference_map_configs() -> List[ClimateDifferenceDataConfig]:
    """
    Create difference map configurations by pairing historical and future data
    """
    difference_configs = []

    for future_config in FUTURE_DATA_SETS:
        # Find matching historical config with same variable and resolution
        historical_config = None
        for hist_config in HISTORIC_DATA_SETS:
            if (
                hist_config.variable_type == future_config.variable_type
                and hist_config.resolution == future_config.resolution
            ):
                historical_config = hist_config
                break

        if historical_config:
            diff_config = ClimateDifferenceDataConfig(
                variable_type=future_config.variable_type,
                filepath="",  # Not used for difference maps
                format=future_config.format,
                resolution=future_config.resolution,
                year_range=future_config.year_range,
                conversion_function=None,
                conversion_factor=1,
                source=f"Difference: {future_config.source} - {historical_config.source}",
                historical_config=historical_config,
                future_config=future_config,
            )
            difference_configs.append(diff_config)

    return difference_configs


DIFFERENCE_DATA_SETS: List[ClimateDifferenceDataConfig] = create_difference_map_configs()
